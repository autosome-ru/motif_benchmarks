FROM alpine
COPY ./pwm_scoring.c ./seqshuffle.c /source/
RUN apk add --virtual .builddeps --update  alpine-sdk R-dev \
    && apk add R \
    && mkdir -p /app/ \
    && gcc -O3 -W -Wall -pedantic -std=gnu99 /source/pwm_scoring.c -o /app/pwm_scoring \
	&& gcc -O3 -W -Wall -pedantic -std=gnu99 /source/seqshuffle.c -o /app/seqshuffle \
    && Rscript -e 'install.packages(c("rjson", "optparse"), repos = "https://cloud.r-project.org/")' \
    && apk del .builddeps
WORKDIR /workdir/
COPY ./calculate_roc.R  /app/
ENTRYPOINT ["/app/calculate_roc.R"]
